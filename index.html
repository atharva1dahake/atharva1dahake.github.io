<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Crop Disease Detection</title>
  <style>
    :root {
      --primary: #059669;
      --light: #ecfdf5;
      --dark: #064e3b;
      --gray: #6b7280;
      --card-bg: #ffffff;
    }

    body {
      margin: 0;
      font-family: "Poppins", "Segoe UI", sans-serif;
      background: linear-gradient(180deg, #ecfdf5 0%, #dcfce7 100%);
      color: #111827;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding-bottom: 60px;
    }

    header {
      background: var(--primary);
      color: white;
      text-align: center;
      padding: 1.8rem 1rem;
      width: 100%;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }

    header h1 { margin: 0; font-size: 2rem; }
    header p { margin-top:8px; color:#d1fae5; font-size:0.95rem; }

    main {
      width: 95%;
      max-width: 700px;
      margin-top: 30px;
      background: var(--card-bg);
      border-radius: 18px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      padding: 30px 25px;
      animation: fadeIn 0.6s ease;
    }

    .upload-area {
      border: 2px dashed var(--primary);
      border-radius: 16px;
      text-align: center;
      padding: 40px 20px 80px;
      background: var(--light);
      cursor: pointer;
      transition: 0.3s;
    }

    .upload-area:hover { background:#d1fae5; transform: translateY(-2px); }

    .btn-file, button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 10px 18px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      transition: 0.3s;
    }

    .btn-file { margin-top: 18px; display:inline-block; }

    .btn-file:hover, button:hover { background: #047857; transform: translateY(-2px); }

    button.ghost { background:#e5e7eb; color:#111827; }
    button.ghost:hover { background:#d1d5db; }

    .controls { display:flex; justify-content:center; gap:12px; margin-top:20px; }

    canvas {
      margin-top: 25px;
      border-radius: 12px;
      max-width: 100%;
      display: none;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .result-box {
      background: var(--light);
      border-left: 4px solid var(--primary);
      padding: 18px;
      border-radius: 12px;
      margin-top: 25px;
      animation: fadeIn 0.4s ease-in-out;
    }

    .info-card {
      background: white;
      border-radius: 14px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      padding: 20px;
      margin-top: 30px;
    }

    .info-card h3 { color: var(--dark); margin-bottom:10px; }
    .info-card ul { padding-left:20px; margin-top:8px; }
    .info-card li { margin-bottom:8px; }
    .small { font-size:0.9em; color:var(--gray); }

    footer { margin-top:40px; font-size:0.9em; color: var(--gray); text-align:center; }

    @keyframes fadeIn { from {opacity:0; transform: translateY(15px);} to {opacity:1; transform: translateY(0);} }
  </style>
</head>

<body>
  <header>
    <h1>ðŸŒ¿ AI Crop Disease Detection</h1>
    <p>Upload a clear leaf photo to analyze crop health</p>
  </header>

  <main>
    <div class="upload-area" id="dropzone">
      <svg width="72" height="72" viewBox="0 0 24 24" fill="none" stroke="#059669" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="7 10 12 15 17 10"/>
        <path d="M12 15V3"/>
      </svg>
      <p>Drag & drop an image, or</p>
      <label class="btn-file" for="fileInput">Choose a file</label>
      <p class="small">JPG/PNG - Clear leaf closeups work best</p>
    </div>

    <input type="file" id="fileInput" accept="image/*" style="display:none;">

    <canvas id="previewCanvas"></canvas>

    <div class="controls">
      <button id="predictBtn" disabled>Analyze</button>
      <button id="resetBtn" class="ghost">Reset</button>
    </div>

    <div id="results"></div>

    <div class="info-card">
      <h3>ðŸ“‹ Info & Tips</h3>
      <ul class="small">
        <li>Use natural sunlight for the clearest images.</li>
        <li>Focus directly on the leaf, avoiding shadows.</li>
        <li>Upload multiple leaves for better accuracy.</li>
      </ul>
    </div>

    <div class="info-card">
      <h3>ðŸ©º Diagnosis & Advice</h3>
      <div id="adviceArea" class="small">
        <p>No result yet.</p>
      </div>
    </div>
  </main>

  <footer>
    âš  Demo version â€” always confirm results with an agronomist.
  </footer>

  <script>
    const fileInput = document.getElementById("fileInput");
    const predictBtn = document.getElementById("predictBtn");
    const resetBtn = document.getElementById("resetBtn");
    const resultsDiv = document.getElementById("results");
    const adviceArea = document.getElementById("adviceArea");
    const canvas = document.getElementById("previewCanvas");
    const ctx = canvas.getContext("2d");
    const dropzone = document.getElementById("dropzone");

    let imgLoaded = false;

    const diseases = [
      { name: "Tomato Leaf Blight", advice: "Remove affected leaves and use a safe fungicide." },
      { name: "Corn Leaf Rust", advice: "Use resistant crop varieties and improve field ventilation." },
      { name: "Potato Early Blight", advice: "Avoid overhead watering and rotate crops yearly." },
      { name: "Rice Brown Spot", advice: "Use nitrogen fertilizer properly and apply fungicide if needed." },
      { name: "Healthy Leaf", advice: "Your crop looks healthy! Maintain regular monitoring." },
      { name: "Banana Sigatoka", advice: "Trim infected leaves and improve airflow in the plantation." },
      { name: "Grape Downy Mildew", advice: "Use copper-based fungicide and water early in the morning." },
      { name: "Sugarcane Mosaic Virus", advice: "Remove infected plants and plant certified virus-free seeds." }
    ];

    function handleFile(file) {
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        const img = new Image();
        img.onload = () => {
          canvas.width = img.width;
          canvas.height = img.height;
          ctx.drawImage(img, 0, 0);
          canvas.style.display = "block";
          imgLoaded = true;
          predictBtn.disabled = false;
        };
        img.src = e.target.result;
      };
      reader.readAsDataURL(file);
    }

    dropzone.addEventListener("click", () => {
      // Mobile & desktop: clicking dropzone opens file picker
      fileInput.click();
    });

    dropzone.addEventListener("dragover", e => {
      e.preventDefault();
      dropzone.style.background = "#ccfbf1";
    });

    dropzone.addEventListener("dragleave", () => {
      dropzone.style.background = "var(--light)";
    });

    dropzone.addEventListener("drop", e => {
      e.preventDefault();
      dropzone.style.background = "var(--light)";
      handleFile(e.dataTransfer.files[0]);
    });

    fileInput.addEventListener("change", function() {
      handleFile(this.files[0]);
    });

    predictBtn.addEventListener("click", () => {
      if (!imgLoaded) return;
      const random = diseases[Math.floor(Math.random() * diseases.length)];
      resultsDiv.innerHTML = `<div class="result-box">ðŸ©º Disease Detected: <b>${random.name}</b></div>`;
      adviceArea.innerHTML = `<p>${random.advice}</p>`;
    });

    resetBtn.addEventListener("click", () => {
      canvas.style.display = "none";
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      resultsDiv.innerHTML = "";
      adviceArea.innerHTML = "<p>No result yet.</p>";
      fileInput.value = "";
      imgLoaded = false;
      predictBtn.disabled = true;
    });
  </script>
</body>
</html>
